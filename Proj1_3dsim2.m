clear
n = 26; m = 88; A = 100; LOADY = 1000; LOADZ = 20000;
joint = [0,0,0;0,40/3,0;0,80/3,0;0,20/3,9.9;0,60/3,9.9;...
    40/3,0,0;40/3,40/3,0;40/3,80/3,0;40/3,20/3,9.9;40/3,60/3,9.9;...
    80/3,0,0;80/3,40/3,0;80/3,80/3,0;80/3,20/3,9.9;80/3,60/3,9.9;...
    40,0,0;40,40/3,0;40,80/3,0;40,20/3,9.9;40,60/3,9.9;...
    40/3,20/3,0;40/3,60/3,0;...
    80/3,20/3,0;80/3,60/3,0;...
    40/3,40/3,9.9;...
    80/3,40/3,9.9;...
    
    ];
assembly = [1,2;1,4;2,3;2,4;2,5;3,5;4,5;...
    1+5,2+5;1+5,4+5;2+5,3+5;2+5,4+5;2+5,5+5;3+5,5+5;4+5,5+5;...
    1+10,2+10;1+10,4+10;2+10,3+10;2+10,4+10;2+10,5+10;3+10,5+10;4+10,5+10;...
    1+15,2+15;1+15,4+15;2+15,3+15;2+15,4+15;2+15,5+15;3+15,5+15;4+15,5+15;...
    1,1+5;1+5,1+10;1+10,1+15;...
    2,2+5;2+5,2+10;2+10,2+15;...
    3,3+5;3+5,3+10;3+10,3+15;...
    4,4+5;4+5,4+10;4+10,4+15;...
    5,5+5;5+5,5+10;5+10,5+15;...
    1,21;2,21;4+5,21;1,4+5;2,4+5;...
    4,25;5,25;2+5,25;4,2+5;5,2+5;...
    2,22;3,22;5+5,22;2,5+5;3,5+5;...
    
    1+5,23;2+5,23;4+10,23;1+5,4+10;2+5,4+10;...
    4+5,26;5+5,26;2+10,26;4+5,2+10;5+5,2+10;...
    2+5,24;3+5,24;5+10,24;2+5,5+10;3+5,5+10;...
    
    1+15,23;2+15,23;4+10,23;1+15,4+10;2+15,4+10;...
    4+15,26;5+15,26;2+10,26;4+15,2+10;5+15,2+10;...
    2+15,24;3+15,24;5+10,24;2+15,5+10;3+15,5+10;...
    
    
    ];
forceJ = [3,1,1,1;3,1,1,1;3,1,1,1;3,1,1,1;3,1,1,1;...
    -1,0,0,0;-1,0,0,0;-1,0,0,0;-1,0,LOADY/2,-LOADZ/4;-1,0,0,-LOADZ/4;...
    -1,0,0,0;-1,0,0,0;-1,0,0,0;-1,0,LOADY/2,-LOADZ/4;-1,0,0,-LOADZ/4;...
    3,1,1,1;3,1,1,1;3,1,1,1;3,1,1,1;3,1,1,1;...
    -1,0,0,0;-1,0,0,0;-1,0,0,0;-1,0,0,0;-1,0,0,0;-1,0,0,0;...
    ];

disp(size(assembly));
index = 1;
for i =  1:m; stretch(i)= 2000000; end; stretch(1);
[Jforce,Mforce,Jdispl,Mdispl] = ...
 truss3(n,m,joint,assembly,forceJ,stretch,index);
%
peak_klb = 18*A
maxMforce_klb = max(abs(Mforce/1000))
maxJdispl = max(abs(Jdispl*12));
maxDX_in = maxJdispl(2),maxDY_in = maxJdispl(3),maxDZ_in = maxJdispl(4)
    